<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="shortcut icon" href="imagens/favicon.png" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
  <title>Carrinho - World Retrô</title>
</head>
<body>

<header>
  <div class="interface">
    <div class="logo">
      <img src="imagens/logo.png" alt="Logo World Retrô">
    </div>
    <nav>
      <a href="index.html">Home</a>
      <a href="carrinho.html">Carrinho</a>
    </nav>
  </div>
</header>

<main>
  <section class="carrinho">
    <h2>Seu Carrinho</h2>
    <div id="cartItems"></div> <!-- Aqui os itens do carrinho serão exibidos -->
    <div id="cartTotal">
      <h3>Total: R$ <span id="totalPrice">0,00</span></h3>
      <div id="installments">
        <!-- Opções de parcelamento serão exibidas aqui -->
      </div>
      <button onclick="finalizarCompra()">Finalizar Compra</button>
    </div>
  </section>
</main>

<script>
// Recuperando o carrinho do localStorage
let cart = JSON.parse(localStorage.getItem('cart')) || [];

// Função para atualizar a tela do carrinho
function updateCart() {
  const cartItemsDiv = document.getElementById('cartItems');
  const totalPriceElement = document.getElementById('totalPrice');
  const installmentsDiv = document.getElementById('installments');

  // Limpa os itens atuais
  cartItemsDiv.innerHTML = '';

  // Adiciona os produtos ao carrinho
  cart.forEach((item, index) => {
    const itemDiv = document.createElement('div');
    itemDiv.classList.add('produto-carrinho');
    itemDiv.innerHTML = `
      <div class="produto-imagem">
        <img src="${item.image}" alt="${item.name}">
      </div>
      <div class="produto-info">
        <p><strong>${item.name}</strong></p>
        <p>Preço: R$ ${item.price}</p>
        <button onclick="removeFromCart(${index})">Remover</button>
      </div>
    `;
    cartItemsDiv.appendChild(itemDiv);
  });

  // Atualiza o total
  const total = cart.reduce((sum, item) => sum + parseFloat(item.price.replace('R$', '').replace(',', '.')), 0);
  totalPriceElement.textContent = total.toFixed(2);

  // Exibe as opções de parcelamento
  const installments = getInstallments(total);
  installmentsDiv.innerHTML = `Até ${installments}x de R$ ${(total / installments).toFixed(2)}`;
}

// Função para remover um item do carrinho
function removeFromCart(index) {
  cart.splice(index, 1);  // Remove o item do carrinho
  localStorage.setItem('cart', JSON.stringify(cart));  // Salva novamente no localStorage
  updateCart();  // Atualiza a tela
}

// Função para calcular o número de parcelas
function getInstallments(total) {
  if (total <= 100) return 1;  // Se o total for menor ou igual a 100, não permite parcelamento
  if (total <= 200) return 3;  // Para totais entre 100 e 200, parcela em até 3 vezes
  if (total <= 300) return 6;  // Para totais entre 200 e 300, parcela em até 6 vezes
  return 12;  // Para totais acima de 300, parcela em até 12 vezes
}

// Função para finalizar a compra (apenas exibe uma mensagem)
function finalizarCompra() {
  alert('Compra finalizada com sucesso!');
  cart = [];  // Limpa o carrinho
  localStorage.setItem('cart', JSON.stringify(cart));  // Atualiza o carrinho no localStorage
  updateCart();  // Atualiza a tela
}

// Inicializa o carrinho
updateCart();
</script>

</body>
</html>
